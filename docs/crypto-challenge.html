<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Challenge - XOR Encryption Binary - Vibe Reversing</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><a href="index.html">Vibe Reversing</a></h1>
            <p class="tagline">Reverse Engineering Notes Generated by LLMs</p>
        </header>
        
        <main>
            <article class="post">
                <div class="post-header">
                    <h1>Crypto Challenge - XOR Encryption Binary</h1>
                    <p class="date">2025-11-02</p>
                </div>
                <div class="post-content">
                    <h1 id="crypto-challenge-xor-encryption-binary">Crypto Challenge - XOR Encryption Binary</h1>
<p>Analysis of a basic cryptography challenge binary implementing XOR encryption.</p>
<h2 id="binary-information">Binary Information</h2>
<p><strong>File:</strong> crypto_challenge<br />
<strong>Type:</strong> ELF 64-bit LSB executable<br />
<strong>Stripped:</strong> No<br />
<strong>Security:</strong> Partial RELRO, NX enabled, No PIE</p>
<h2 id="functionality-overview">Functionality Overview</h2>
<p>The binary implements a simple XOR-based encryption scheme. It reads input from the user and encrypts it using a repeating key.</p>
<h2 id="key-findings">Key Findings</h2>
<h3 id="1-encryption-algorithm">1. Encryption Algorithm</h3>
<p>The binary uses a simple XOR cipher with a repeating key:</p>
<div class="codehilite"><pre><span></span><code><span class="kt">void</span><span class="w"> </span><span class="nf">encrypt</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">keylen</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">^=</span><span class="w"> </span><span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">keylen</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="2-hardcoded-key">2. Hardcoded Key</h3>
<p>The encryption key is hardcoded in the binary at address <code>0x402020</code>:</p>
<div class="codehilite"><pre><span></span><code>Key: &quot;SecretKey123&quot;
Length: 12 bytes
</code></pre></div>

<h3 id="3-vulnerable-functions">3. Vulnerable Functions</h3>
<p>The binary contains several potentially vulnerable functions:</p>
<ul>
<li><code>gets()</code> - Buffer overflow vulnerability</li>
<li><code>strcpy()</code> - No bounds checking</li>
<li>Stack-based buffer (256 bytes) without protection</li>
</ul>
<h2 id="exploitation-notes">Exploitation Notes</h2>
<h3 id="buffer-overflow">Buffer Overflow</h3>
<p>The use of <code>gets()</code> allows for a classic buffer overflow:</p>
<ol>
<li>Input buffer is 256 bytes</li>
<li>No bounds checking on input</li>
<li>Return address can be overwritten</li>
</ol>
<h3 id="proof-of-concept">Proof of Concept</h3>
<div class="codehilite"><pre><span></span><code>python<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;print(&quot;A&quot; * 264 + &quot;\x41\x42\x43\x44&quot;)&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>./crypto_challenge
</code></pre></div>

<h2 id="decryption">Decryption</h2>
<p>Since the key is known, encrypted data can be easily decrypted:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">byte</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">byte</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)]))</span>
    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="n">encrypted</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;</span><span class="se">\x17\x00\x1d\x12</span><span class="s2">...&quot;</span>
<span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;SecretKey123&quot;</span>
<span class="n">plaintext</span> <span class="o">=</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
</code></pre></div>

<h2 id="recommendations">Recommendations</h2>
<ol>
<li>Replace <code>gets()</code> with <code>fgets()</code> or safer alternatives</li>
<li>Implement proper input validation</li>
<li>Use modern cryptographic libraries (e.g., OpenSSL)</li>
<li>Enable stack canaries and ASLR</li>
<li>Consider using a proper encryption algorithm (AES, ChaCha20)</li>
</ol>
<h2 id="conclusion">Conclusion</h2>
<p>This binary demonstrates common vulnerabilities in cryptographic implementations and input handling. The combination of weak encryption and buffer overflow vulnerabilities makes it an excellent learning example for security researchers.</p>
<hr />
<p><em>Analysis date: 2025-11-02</em></p>
                </div>
            </article>
            
            <nav class="post-nav">
                <a href="index.html">← Back to all notes</a>
            </nav>
        </main>
        
        <footer>
            <p>Generated with ❤️ for reverse engineering</p>
        </footer>
    </div>
</body>
</html>
